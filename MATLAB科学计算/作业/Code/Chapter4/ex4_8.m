clc,clearvars;
[x,y]=meshgrid(0.1:0.1:1.1);
z=[0.83041,0.82727,0.82406,0.82098,0.81824,0.8161,0.81481,0.81463,0.81579,0.81853,0.82304;
0.83172,0.83249,0.83584,0.84201,0.85125,0.86376,0.87975,0.89935,0.92263,0.94959,0.9801;
0.83587,0.84345,0.85631,0.87466,0.89867,0.9284,0.96377,1.0045,1.0502,1.1,1.1529;
0.84286,0.86013,0.88537,0.91865,0.95985,1.0086,1.0642,1.1253,1.1904,1.257,1.3222;
0.85268,0.88251,0.92286,0.97346,1.0336,1.1019,1.1764,1.254,1.3308,1.4017,1.4605;
0.86532,0.91049,0.96847,1.0383,1.118,1.2046,1.2937,1.3793,1.4539,1.5086,1.5335;
0.88078,0.94396,1.0217,1.1118,1.2102,1.311,1.4063,1.4859,1.5377,1.5484,1.5052;
0.89904,0.98276,1.082,1.1922,1.3061,1.4138,1.5021,1.5555,1.5573,1.4915,1.346;
0.92006,1.0266,1.1482,1.2768,1.4005,1.5034,1.5661,1.5678,1.4889,1.3156,1.0454;
0.94381,1.0752,1.2191,1.3624,1.4866,1.5684,1.5821,1.5032,1.315,1.0155,0.62477;
0.97023,1.1279,1.2929,1.4448,1.5564,1.5964,1.5341,1.3473,1.0321,0.61268,0.14763];
x1 = x(:);
y1 = y(:);
z1 = z(:);
A = [sin(x1.^2.*y1),cos(y1.^2.*x1),(x1.^2),(x1.*y1),ones(121,1)];
xx = A\z1
f = @(x,y) xx(1)*sin(x.^2.*y)+xx(2)*cos(y.^2.*x)+xx(3)*x.^2+xx(4)*x.*y+xx(5);
[x0,y0]=meshgrid(0.1:0.1:1.1);
z0=f(x0,y0);
subplot(1,3,1)
mesh(x0,y0,z);
title("原始值")
subplot(1,3,2);
mesh(x0,y0,z0);
title("最小二乘解")
subplot(1,3,3);
mesh(x0,y0,abs(z0-z))
title("误差")



