clc,clearvars;
x=[-2,-1.7,-1.4,-1.1,-0.8,-0.5,-0.2,0.1,0.4,0.7,1,1.3,...
1.6,1.9,2.2,2.5,2.8,3.1,3.4,3.7,4,4.3,4.6,4.9];

y=[0.10289,0.11741,0.13158,0.14483,0.15656,0.16622,0.17332,...
0.1775,0.17853,0.17635,0.17109,0.16302,0.15255,0.1402,...
0.12655,0.11219,0.09768,0.08353,0.07019,0.05786,0.04687,...
0.03729,0.02914,0.02236];

% 分段三次样条
subplot(2,2,1)
sp1=csapi(x,y); 
fnplt(sp1);  
hold on;
scatter(x,y);
title("分段三次样条")
% 5次 B样条插值
subplot(2,2,2)
sp2=spapi(5,x,y); 
fnplt(sp2);
hold on;
scatter(x,y);
title("5次B样条插值")

% 分段三次样条
x0=0.1:0.1:1.1;
y0=0.1:0.1:1.1;
z0=[0.83041,0.82727,0.82406,0.82098,0.81824,0.8161,0.81481,0.81463,0.81579,0.81853,0.82304;
0.83172,0.83249,0.83584,0.84201,0.85125,0.86376,0.87975,0.89935,0.92263,0.94959,0.9801;
0.83587,0.84345,0.85631,0.87466,0.89867,0.9284,0.96377,1.0045,1.0502,1.1,1.1529;
0.84286,0.86013,0.88537,0.91865,0.95985,1.0086,1.0642,1.1253,1.1904,1.257,1.3222;
0.85268,0.88251,0.92286,0.97346,1.0336,1.1019,1.1764,1.254,1.3308,1.4017,1.4605;
0.86532,0.91049,0.96847,1.0383,1.118,1.2046,1.2937,1.3793,1.4539,1.5086,1.5335;
0.88078,0.94396,1.0217,1.1118,1.2102,1.311,1.4063,1.4859,1.5377,1.5484,1.5052;
0.89904,0.98276,1.082,1.1922,1.3061,1.4138,1.5021,1.5555,1.5573,1.4915,1.346;
0.92006,1.0266,1.1482,1.2768,1.4005,1.5034,1.5661,1.5678,1.4889,1.3156,1.0454;
0.94381,1.0752,1.2191,1.3624,1.4866,1.5684,1.5821,1.5032,1.315,1.0155,0.62477;
0.97023,1.1279,1.2929,1.4448,1.5564,1.5964,1.5341,1.3473,1.0321,0.61268,0.14763];
subplot(2,2,3)
sp3=csapi({x0,y0},z0); 
dspxy=fnder(sp3,[0.1,1.1]);  
fnplt(dspxy)
title("分段三次样条")

% B样条插值
subplot(2,2,4)
sp4=spapi({5,5},{x0,y0},z0); 
dspxy2=fnder(sp4,[0.1,1.1]);  
fnplt(dspxy2)
title("5次B样条插值")